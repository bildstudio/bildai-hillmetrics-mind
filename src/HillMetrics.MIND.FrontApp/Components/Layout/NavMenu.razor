@using MudBlazor
@using Microsoft.Extensions.Options
@using HillMetrics.MIND.FrontApp.Configs
@inject NavigationManager NavigationManager
@inject IOptions<FeaturesConfig> FeaturesConfig

<MudNavMenu>
    <AuthorizeView>
        <Authorized>
            <MudNav>
                <MudNavLink Href="" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Dashboard">
                    Dashboard
                </MudNavLink>
                <MudNavGroup Title="Flux Management" Icon="@Icons.Material.Filled.Stream" Expanded="true">
                    <MudNavGroup Title="Basics" Icon="@Icons.Material.Filled.ViewList" Expanded="false">
                        <MudNavLink Href="/flux/search" Icon="@Icons.Material.Filled.Search">
                            Search Flux
                        </MudNavLink>
                        <MudNavLink Href="/email/search" Icon="@Icons.Material.Filled.Email">
                            Search Emails
                        </MudNavLink>
                        <MudNavLink Href="/flux/fetching-history" Icon="@Icons.Material.Filled.History">
                            Fetching History
                        </MudNavLink>
                        <MudNavLink Href="/flux/processing-history" Icon="@Icons.Material.Filled.Timeline">
                            Processing History
                        </MudNavLink>
                        <MudNavLink Href="/flux/errors" Icon="@Icons.Material.Filled.ErrorOutline">
                            Errors
                        </MudNavLink>
                        <MudNavLink Href="/flux/rule-errors" Icon="@Icons.Material.Filled.BugReport">
                            Rule Errors
                        </MudNavLink>
                    </MudNavGroup>

                    <MudNavGroup Title="Flux Caracs" Icon="@Icons.Material.Filled.Schema" Expanded="false">
                        <MudNavLink Href="/financial-data/search" Icon="@Icons.Material.Filled.Analytics">
                            Search Data Points
                        </MudNavLink>
                        <MudNavLink Href="/property-mapping/search" Icon="@Icons.Material.Filled.AccountTree">
                            Search Property Mapping
                        </MudNavLink>
                        <MudNavLink Href="/document-type/search" Icon="@Icons.Material.Filled.Description">
                            Search Document types
                        </MudNavLink>
                        <MudNavLink Href="/language/search" Icon="@Icons.Material.Filled.Language">
                            Search Languages
                        </MudNavLink>
                        <MudNavLink Href="/prompt/search" Icon="@Icons.Material.Filled.DataArray">
                            Search Prompts
                        </MudNavLink>
                    </MudNavGroup>

                    <MudNavGroup Title="Flux / Sandbox mapping" Icon="@Icons.Material.Filled.Hub" Expanded="false">
                        <MudNavLink Href="/flux-mappings/search" Icon="@Icons.Material.Filled.TableChart">
                            Mapping Search
                        </MudNavLink>
                        <MudNavLink Href="/file-data-mapping" Icon="@Icons.Material.Filled.AddLink">
                            Create Mapping
                        </MudNavLink>
                        <MudNavLink Href="/flux-sandbox" Icon="@Icons.Material.Filled.Science">
                            Sandbox
                        </MudNavLink>
                    </MudNavGroup>
                </MudNavGroup>

                <MudNavGroup Title="Market" Icon="@Icons.Material.Filled.TrendingUp" Expanded="false">
                    <MudNavLink Href="/prices/search" Icon="@Icons.Material.Filled.AttachMoney">
                        Search Prices
                    </MudNavLink>
                    <MudNavLink Href="/trading-venue/search" Icon="@Icons.Material.Filled.Store">
                        Search Trading Venues
                    </MudNavLink>
                    <MudNavLink Href="/refined/force-calcul" Icon="@Icons.Material.Filled.Functions">
                        Force Calcul Refined
                    </MudNavLink>
                </MudNavGroup>
            </MudNav>

            <MudNav>
                
                <MudNavGroup Title="AI" Icon="@Icons.Material.Filled.SmartToy" Expanded="true">
                    @if (FeaturesConfig.Value.AiChat.Enabled)
                    {
                        <MudNavLink Href="/ai/chat" Icon="@Icons.Material.Filled.Chat">
                            AI Chat
                        </MudNavLink>
                    }
                    <MudNavLink Href="/llms/search" Icon="@Icons.Material.Filled.FindInPage">
                        Models
                    </MudNavLink>
                    <MudNavLink Href="/ai-endpoints/search" Icon="@Icons.Material.Filled.Search">
                        Endpoints
                    </MudNavLink>
                </MudNavGroup>
                <MudNavGroup Title="Audit" Icon="@Icons.Material.Filled.ManageSearch" Expanded="true">
                    <MudNavLink Href="/audit/search" Icon="@Icons.Material.Filled.FindInPage">
                        Audit
                    </MudNavLink>
                    <MudNavLink Href="/audit/flux" Icon="@Icons.Material.Filled.AccountTree">
                        Flux Audit Logs
                    </MudNavLink>
                </MudNavGroup>
            </MudNav>
            <MudDivider Class="my-2" />

            <MudNav>
                <MudNavGroup Title="Administration" Icon="@Icons.Material.Filled.AdminPanelSettings" Expanded="false">
                    <MudNavLink Href="/settings" Icon="@Icons.Material.Filled.Tune">
                        Settings
                    </MudNavLink>
                    <MudNavLink Href="/logs" Icon="@Icons.Material.Filled.Assignment">
                        System Logs
                    </MudNavLink>
                </MudNavGroup>

                <MudNavLink Href="/help" Icon="@Icons.Material.Filled.HelpOutline">
                    Help & Documentation
                </MudNavLink>
            </MudNav>
        </Authorized>
    </AuthorizeView>
    @*authentication component*@
    <AuthMudNavMenuComponent />
</MudNavMenu>

@code {
    private bool IsActive(string href)
    {
        var relativePath = NavigationManager.ToBaseRelativePath(NavigationManager.Uri);
        return relativePath.StartsWith(href);
    }
}

